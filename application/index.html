<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="https://cybersecurity1.com/application/">
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Application - NoleneHuman__Capstone</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css">
        <link href="../stylesheets/extra.css" rel="stylesheet">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-dark">
            <div class="container">
                <a class="navbar-brand" href="..">NoleneHuman__Capstone</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href=".." class="nav-link">Home</a>
                            </li>
                            <li class="navitem">
                                <a href="../security/" class="nav-link">Scope</a>
                            </li>
                            <li class="navitem">
                                <a href="../networking/" class="nav-link">Network</a>
                            </li>
                            <li class="navitem active">
                                <a href="./" class="nav-link">Application</a>
                            </li>
                            <li class="navitem">
                                <a href="../cryptography/" class="nav-link">Cryptography</a>
                            </li>
                            <li class="navitem">
                                <a href="../database/" class="nav-link">Database</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../networking/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../cryptography/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="2"><a href="#before-development-begins" class="nav-link">Before Development Begins</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="2"><a href="#during-design" class="nav-link">During Design</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="2"><a href="#during-development" class="nav-link">During Development</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="2"><a href="#cybok-knowledge-applied" class="nav-link">CyBOK knowledge applied</a>
              <ul class="nav flex-column">
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<p><img alt="Scanned Network" src="../app.png" /></p>
<h3 style="color:rgb(167, 22, 102)">Goal</h3>

<p>The goal is to imporve my application security and reduce the risk of attacks by testing the application througout the Software Development Life Cycle.
This document is recording the 'the test early and test often' methodology applied threat modeling, automated testing (Snyk), code review and pentesting techniques.  </p>
<h3 style="color:rgb(167, 22, 102)">The Journey</h3>

<h2 id="before-development-begins">Before Development Begins</h2>
<p>I created a threat model using Microsoft Thread Modeling Tool to identify the possible threats on a basic login function using a typical login form.
The results identified an extensive list of threats that can be avoided during built and the basis of the metrics criteria.</p>
<p><strong> Threat Model </strong></p>
<p>The standard Login Threat Model based on original design
<img alt="Login Threat Model" src="../image-9.png" /></p>
<p><strong> Measurement and Metrics Criteria and Ensure Traceability </strong></p>
<p>Denial Of Service</p>
<ul class="task-list">
<li class="task-list-item">
<p><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Potential Excessive Resource Consumption for Web Application or check login credentials </p>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Use Multi-Factor Authentication (MFA)</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Limit Login Attempts <br><br>
Other</li>
<li>Credential Storage : Store user credentials securely using hashing and salting techniques <a href="/cryptography">see cryptography</a><br></li>
<li>Credential Verification : hash the provided password in the same way as the stored hash, and compare the two. If they match, the password is correct.<a href="/cryptography">see cryptography</a><br></li>
<li>Secure Transmission : Always transmit credentials securely using encryption protocols like HTTPS.<a href="/networking">see network</a><br></li>
<li>Implement input validation : Define and enforce maximum size limits for all incoming parameters and payloads<a href="/networking">see network</a><br></li>
<li>Use load balancing : Distribute traffic across multiple servers<a href="/networking">see network</a><br></li>
<li>Implement server-side caching : This can reduce the number of requests to the server<a href="/networking">see network</a><br></li>
<li>Monitor and log server activity : This can help detect and respond to unusual resource consumption<a href="/networking">see network</a><br>
<br></li>
</ul>
</li>
<li class="task-list-item">
<p><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Data Flow HTTPS Is Potentially Interrupted</p>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Implement a Web Application Firewall (WAF)<a href="/networking">see network</a><br><br> </li>
</ul>
</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Potential Process Crash or Stop for Web Application <p style="color:rgb(167, 22, 102)"> outside of scope<p></li>
</ul>
<p><br>
Elevation of Privilege</p>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Cross Site Request Forgery </li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Elevation by Changing the Execution Flow in Web Application </li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Web Application May be Subject to Elevation of Privilege Using Remote Code Execution </li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Elevation Using Impersonation</li>
</ul>
<p>Information Disclosure</p>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Weak Credential Storage</li>
</ul>
<p>Repudiation</p>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Potential Weak Protections for Audit Data </li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Insufficient Auditing </li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Lower Trusted Subject Updates Logs</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Data Logs from an Unknown Source </li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Potential Data Repudiation by Web Application</li>
</ul>
<p>Tampering</p>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Risks from Logging </li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Cross Site Scripting</li>
</ul>
<p>Spoofing</p>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Spoofing of Destination Data Store login</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Spoofing the Browser External Entity</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Spoofing of Destination Data Store SQL Database <a href="/database">see database</a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Spoofing of Source Data Store check login credentials <a href="/database">see database</a></li>
</ul>
<p><strong> Authentication </strong>: Use standard authentication mechanisms to verify the identity of the source data store. This could involve using secure protocols such as HTTPS which provide built-in authentication.</p>
<p><strong> Input Validation </strong>: Ensure that all inputs are validated and sanitized to prevent malicious inputs from being processed.</p>
<p><strong> Least Privilege Access </strong>: Implement least privilege access controls so that even if an attacker is able to spoof a source, they would not have sufficient privileges to perform harmful actions</p>
<p><strong> Monitoring and Logging</strong> : Regularly monitor and log activities to detect any unusual behavior or access patterns</p>
<h2 id="during-design">During Design</h2>
<p><strong><em>Security Requirements</em></strong></p>
<ul>
<li>User management</li>
<li>Authentication</li>
<li>Authorization</li>
<li>Data confidentiality</li>
<li>Integrity</li>
<li>Accountability</li>
<li>Session management</li>
<li>Transport security</li>
<li>Tiered system segregation </li>
</ul>
<p><strong> Step 1 : Basic Login and possible vulnerabilities </strong></p>
<p>Is started out with a standard login page and listed the common vulnerabilities.</p>
<p><img alt="Step1" src="../image-17.png" /></p>
<p><strong> Step 2 : Improved vulnerabilities through design </strong></p>
<p>Redesigned the login page to remove design vulnerabilities:</p>
<p><img alt="Alt text" src="../image-18.png" /></p>
<h2 id="during-development">During Development</h2>
<p>💢 <strong> The line between security and convenience </strong></p>
<p>The first hurdle is to reduce the risks wihtout building an annoying user experience.</p>
<p>During the development phase the design concept was combined with the practical aproach with questions like:</p>
<ul>
<li>Remove the risk of a weak password with a unique passphrase (token) emailed to user,</li>
<li>Enforce One Time Passcode,</li>
<li>Implement captcha,</li>
<li>all of the above</li>
</ul>
<p><br></p>
<p><img alt="Alt text" src="../image-19.png" /></p>
<p>Secure: Flask provides built-in support for handling common web security features like cross-site request forgery (CSRF) protection and secure cookie handling.</p>
<p><strong><em>References</em></strong></p>
<p><a href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/03-Identity_Management_Testing/README">Testing for Account Enumeration and Guessable User Account</a></p>
<p><a href="https://www.strongdm.com/blog/authentication-vulnerabilities">11 Common Authentication Vulnerabilities You Need to Know</a></p>
<hr />
<hr />
<h2 id="cybok-knowledge-applied">CyBOK knowledge applied</h2>
<ul>
<li>
<p><strong>categories of vulnerabilities</strong></p>
<ul>
<li><strong>CVEs and CWEs</strong></li>
<li>
<p><strong>memory management vulnerabilities</strong></p>
<p>attacks</p>
<p>code corruption attacks</p>
<p>control-flow hijack attacks</p>
<p>information leak attack</p>
<p>data-only-attacks</p>
<p>safe languages</p>
<p>temporal vulnerabilities</p>
<p>spatial vulnerabilities</p>
</li>
<li>
<p>structured output generation vulnerabilities</p>
<p>SQL injection</p>
<p>command injection vulnerabilities</p>
<p>script injection vulnerabilities (XSS)</p>
<p>stored injection vulnerabilites</p>
<p>higher-order injection vulnerabilities</p>
</li>
<li>
<p><strong>race condition vulnerabilities</strong></p>
<p>concurrency bugs</p>
<p>time-of-check to time-of-use</p>
</li>
<li>
<p><strong>API vulnerabilities</strong></p>
<p>correct use</p>
<p>correct implementation</p>
</li>
<li>
<p><strong>side-channel vulnerabilities</strong></p>
<p>software-based side-channels</p>
<p>covert channels</p>
<p>micro-architectual effects</p>
<p>fault-injection attacks</p>
<p>physical fault-injection</p>
<p>software fault-injection</p>
<p>Rowhammer</p>
</li>
</ul>
</li>
<li>
<p><strong>prevention of vulnerabilities</strong></p>
<ul>
<li>
<p><strong>API design</strong></p>
<p>defensive programming</p>
<p>sandboxing</p>
<p>principle of least privilege</p>
<p>assertions</p>
<p>contracts</p>
</li>
<li>
<p><strong>coding practices</strong></p>
<p>coding guidelines</p>
<p>MISRA</p>
<p>dangerous functions</p>
<p>programming idioms</p>
<p>resource acquisition is initialisation</p>
<p>move semantics</p>
<p>smart pointers</p>
<p>checking compliance</p>
</li>
<li>
<p><strong>erroneous execution</strong></p>
<p>trapped errors</p>
<p>untrapped errors</p>
</li>
<li>
<p><strong>language design and type systems</strong></p>
<p>memory management mitigations</p>
<p>immutable state</p>
<p>dynamic checks</p>
<p>static checks</p>
</li>
<li>
<p><strong>structured output generations mitigations</strong></p>
<p>type systems</p>
<p>query generation</p>
</li>
<li>
<p><strong>race condition mitigation</strong></p>
<p>ownership</p>
<p>aliasing</p>
</li>
<li>
<p><strong>information flow</strong></p>
</li>
<li><strong>mitigating exploitation</strong></li>
<li>
<p><strong>runtime detection of attacks</strong></p>
<p>stack canaries
non-executable memory</p>
<p>control fow integrity</p>
</li>
<li>
<p><strong>automated software diversity</strong></p>
<p>ASLR</p>
</li>
<li>
<p><strong>limiting privileges</strong></p>
<ul>
<li>
<p><strong>sandboxing</strong></p>
<p>monitors</p>
<p>jails</p>
</li>
</ul>
<p>compartmentalisation</p>
<p>object-capability systems</p>
</li>
</ul>
</li>
<li>
<p><strong>detection of vulnerabilities</strong></p>
</li>
</ul></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../js/jquery-3.6.0.min.js"></script>
        <script src="../js/bootstrap.min.js"></script>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js"></script>
        <script src="../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
