<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="https://cybersecurity1.com/application/">
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Application - NoleneHuman__Capstone</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css">
        <link href="../stylesheets/extra.css" rel="stylesheet">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
     <link href="../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
        html.glightbox-open { overflow: initial; height: 100%; }
        .gslide-title { margin-top: 0px; user-select: text; }
        .gslide-desc { color: #666; user-select: text; }
        .gslide-image img { background: white; }
        </style> <script src="../assets/javascripts/glightbox.min.js"></script></head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-dark">
            <div class="container">
                <a class="navbar-brand" href="..">NoleneHuman__Capstone</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href=".." class="nav-link">Home</a>
                            </li>
                            <li class="navitem">
                                <a href="../security/" class="nav-link">Scope</a>
                            </li>
                            <li class="navitem active">
                                <a href="./" class="nav-link">Application</a>
                            </li>
                            <li class="navitem">
                                <a href="../cryptography/" class="nav-link">Cryptography</a>
                            </li>
                            <li class="navitem">
                                <a href="../database/" class="nav-link">Database</a>
                            </li>
                            <li class="navitem">
                                <a href="../networking/" class="nav-link">Network</a>
                            </li>
                            <li class="navitem">
                                <a href="../discoveries.md" class="nav-link">Other</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                            <li class="nav-item">
                                <a rel="prev" href="../security/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../cryptography/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#fang-education" class="nav-link">Fang Education</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#application-vulnerability-score" class="nav-link">Application Vulnerability Score</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#conclusion" class="nav-link">Conclusion</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#pentesting" class="nav-link">Pentesting</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#during-development" class="nav-link">During Development</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#during-deployment" class="nav-link">During Deployment</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#pentesting_1" class="nav-link">Pentesting</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#resolution" class="nav-link">Resolution</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#fang-services" class="nav-link">Fang Services</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#application-vulnerability-score_1" class="nav-link">Application Vulnerability Score</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#before-development-begins" class="nav-link">Before Development Begins</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#during-design" class="nav-link">During Design</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#during-development_1" class="nav-link">During Development</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#cybok-knowledge-applied" class="nav-link">CyBOK knowledge applied</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<p><a class="glightbox" href="../app.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Scanned Network" src="../app.png" /></a></p>
<h1 id="fang-education">Fang Education</h1>
<h2 id="application-vulnerability-score">Application Vulnerability Score</h2>
<table>
<thead>
<tr>
<th style="text-align: left;">PHASE</th>
<th style="text-align: left;">Vulnerability Score</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">During Built</td>
<td style="text-align: left;"><p style='color:RED'>CRITICAL</p></td>
</tr>
<tr>
<td style="text-align: left;">Before Design</td>
<td style="text-align: left;"><p style='color:green'>ZERO</p></td>
</tr>
<tr>
<td style="text-align: left;">Launched</td>
<td style="text-align: left;"><p style='color:orange'>MEDIUM</p></td>
</tr>
</tbody>
</table>
<hr />
<h2 id="conclusion">Conclusion</h2>
<p>Streamlit does not offer CSP headers but has Cross-Origin Resource Sharing (CORS) hard coded into the stack. Bug Bounty programs identified that even setting the headers won't always protect against XSS and Clickjacking. 
During Pentesting against XSS failed. There was no resources to test clickjacking except for inserting the application in an iframe, overlaying it with malicious code. Through social engineering the attacker will then be able to attack unsuspected users.</p>
<p>The risk was reduce through input validation and output encoding.
In conclusion, I will not recommend using this stack for high-risk applications. </p>
<hr />
<h1 id="pentesting">Pentesting</h1>
<p>Fang Education is a non-technical cyberscurity educational web application tool. </p>
<p>Funtions included<br>
- What is Fang<br>
- CyberSecurity Tips<br>
- Learn Home Cybersecurity <br>
- Take the Vulnerability Test<br>
- Contact Us<br></p>
<p>This application is built using:</p>
<ul>
<li>Python and, <br></li>
<li><a href="https://streamlit.io/">Streamlit</a>, an open source app framework</li>
</ul>
<h2 id="during-development">During Development</h2>
<h3 id="code-review">Code Review</h3>
<p><a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP TOP 10 : A05:2021 – Security Misconfiguration</a><br></p>
<p style='color:red'> You are likely vulnerable:</p>
<blockquote>
<ul>
<li>Unnecessary features are enabled or installed (e.g., unnecessary ports, services, pages, accounts, or privileges).</li>
</ul>
</blockquote>
<p>Removed all libraries and documents not being used by the application.
<a class="glightbox" href="../image-43.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="OWASP5" src="../image-43.png" /></a></p>
<h3 id="vulnerability-scanner">Vulnerability Scanner</h3>
<p><a href="https://app.snyk.io/">Snyk</a> was used to scan the code for vulnerabilities once the application was finished.</p>
<p><a href="https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/">OWASP TOP 10 : A06:2021 – Vulnerable and Outdated Components</a></p>
<p style='color:red'>You are likely vulnerable:</p>
<blockquote>
<ul>
<li>If you do not secure the components’ configurations</li>
<li>If you do not scan for vulnerabilities regularly and subscribe to security bulletins related to the components you use</li>
</ul>
</blockquote>
<p>🔐 <b>D1 to D4 Resolved</b><br>
All  it took was to update Streamlit from version ==1.23.0 to ==1.28.1 for <em>ALL</em> vulnerabilities to be fixed.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>pip install -U streamlit
</span></code></pre></div>
<p>🔐 Snyk sends a weekly security update on vulnerabilities identified in GIT repositories</p>
<p><strong>Lesson learnt</strong></p>
<p>💪Do not wait until the end of the built before doing vulnerability testing. This applicatin was not feature rich, and fixing the vulnerabilities was easy. For my more complicated applications, a more robust process needs to be followed.</p>
<h4 style='color:rgb(167, 22, 102)'> Scan Result Before Fix</h4>

<p><a class="glightbox" href="../image-39.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="FangEDU_Snyk" src="../image-39.png" /></a></p>
<table>
  <tr>
    <th>Number</th>
    <th>Threat</th>
    <th>Vulnerability</th>
    <th>Description</th>
  </tr>
<tr>
    <td>D1</td>
    <td style='color:red'>Critical</td>
    <td>Heap-based Buffer Overflow</td>
    <td>Pillow is a PIL (Python Imaging Library) fork.

Affected versions of this package are vulnerable to Heap-based Buffer Overflow when the ReadHuffmanCodes() function is used. An attacker can craft a special WebP lossless file that triggers the ReadHuffmanCodes() function to allocate the HuffmanCode buffer with a size that comes from an array of precomputed sizes: kTableSize. The color_cache_bits value defines which size to use. The kTableSize array only takes into account sizes for 8-bit first-level table lookups but not second-level table lookups. libwebp allows codes that are up to 15-bit (MAX_ALLOWED_CODE_LENGTH). When BuildHuffmanTable() attempts to fill the second-level tables it may write data out-of-bounds. The OOB write to the undersized array happens in ReplicateValu</td>
  </tr>
  <tr>
    <td>D2</td>
    <td style='color:orange'>Medium</td>
    <td>Validator: Regular Expression Denial of Service (ReDoS)</td>
    <td>validators is a package for Python Data Validation for Humans.

Affected versions of this package are vulnerable to Regular Expression Denial of Service (ReDoS) via the torbot.modules.validators.validate_link function. An attacker can cause an application crash by using a well-crafted argument. This is due to the use of a regular expression with exponential complexity. An attacker can exploit this by using a well-crafted URL argument, causing a Denial of Service on the syste</td>
  </tr>

  <tr>
    <td>D3</td>
    <td style='color:orange'>Medium</td>
    <td>HTTP Request Smuggling</td>
    <td>tornado is a Python web framework and asynchronous networking library, originally developed at FriendFeed.

Affected versions of this package are vulnerable to HTTP Request Smuggling via the parse and validate strings capabilities in the int constructor</td>
  </tr>

<tr>
    <td>D4</td>
    <td style='color:orange'>Medium</td>
    <td>Improper Output Neutralization for Logs</td>
    <td>streamlit is a The fastest way to build data apps in Python

Affected versions of this package are vulnerable to Improper Output Neutralization for Logs when the function upload_file_request_handler.py returns 400 error including the session_id value</td>
  </tr>
</table>

<h4 style='color:rgb(167, 22, 102)'> Scan Result After Fix</h4>

<p><a class="glightbox" href="../image-41.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Alt text" src="../image-41.png" /></a>
<a class="glightbox" href="../image-40.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Alt text" src="../image-40.png" /></a></p>
<h2 id="during-deployment">During Deployment</h2>
<p>💢 The application was launched on the Web Service <a href="https://render.com/">Render</a>. The application was not able to launch using the latest version of Streamlit. The latest version accepted by the hosting service is 1.23.1.</p>
<p><a class="glightbox" href="../image-44.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Alt text" src="../image-44.png" /></a></p>
<p>When the application is launched using Render the vulnerability status changed from Null to Medium when scanned by <a href="https://hostedscan.com/">HostedScan</a>, using OWASP ZAP.</p>
<p>The vulnerabilies are not the same as identified by Snyk. Two options for launching:</p>
<ul>
<li>Accept the risk identified by Snyk however not an issue at launch and fixed new vulnerabilities or,</li>
<li>Find another hosting service that will launch with the latest Streamlit version </li>
</ul>
<h4 style='color:rgb(167, 22, 102)'> Scan Result Before Fix</h4>

<p><a class="glightbox" href="../image-45.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Alt text" src="../image-45.png" /></a></p>
<table>
  <tr>
    <th>Number</th>
    <th>Threat</th>
    <th>Vulnerability</th>
    <th>Description</th>
  </tr>

<tr>
    <td>L1</td>
    <td style='color:orange'>Medium</td>
    <td>Missing Anti-clickjacking Header</td>
    <td>the response does not include either Content-Security-Policy with 'frame-ancestors' directive or X-Frame-Options to protect against 'ClickJacking' attacks.</td>
</tr>

<tr>
    <td>L2</td>
    <td style='color:orange'>Medium</td>
    <td> Content Security Policy (CSP) Header Not Set</td>
    <td>Content Security Policy (CSP) is an added layer of security that helps to detect and mitigate certain types of attacks, including Cross Site Scripting (XSS) and data injection attacks. These attacks are used for everything from data theft to site defacement or distribution of malware. CSP provides a set of standard HTTP headers that allow website owners to declare approved sources of content that browsers should be allowed to load on that page — covered types are JavaScript, CSS, HTML frames, fonts, images and embeddable objects such as Java applets, ActiveX, audio and video files.</td>
</tr>
</table>
<p><br></p>
<h2 id="pentesting_1">Pentesting</h2>
<p style='color:red'> 🚨 Streamlit, as at the date of launch do not allow setting http headers to mitigate threat! </p>
<p><a href="https://discuss.streamlit.io/t/no-csp-header-in-the-http-response/36537">Streamlit : CSP</a><br></p>
<p>HTTP headers are set to provide an additional layer of defence against attacks. However, in some instances, an application would not want to set these headers, as, for example, an application might allow inframe embedding (prevented by the x-frame header option).</p>
<p>Further research into what each header does or prevents was required to be able to see if the missing headers have a real impact.</p>
<p><b>X-Frame Option</b>
Is the page allowed to render in an iframe? An iframe embeds another URL into a web page and, if allowed, can cause clickjacking attacks. (L1)</p>
<p><b>Content Security Policy (CSP)</b>
Is an additional defence against cross-site scripting (XSS), but setting a header in itself will not protect against XSS.</p>
<p><b>Strict Transport Security Headers</b>
Setting strict transport security headers prevents man-in-the-middle attacks. For example, if a user does not explicitly enter HTTPS and just enter fang.onrender.com, then the browser can direct the user to http://fang.onrender.com instead of the correct https://fang.onrender.com site.</p>
<p>Further research watching Bug Bounty Tips revealed that missing headers do not necessarily equate to a vulnerable site. Further penetration testing is required to assess the probability of the vulnerabilities.</p>
<p>During website enumeration the page most vulnerable to </p>
<table>
  <tr>
    <th>Number</th>
    <th>Vulnerability</th>
    <th>Solution</th>
    <th>Test</th>
  </tr>
<tr>
    <td>L1</td>
    <td>Missing Anti-clickjacking Header</td>
    <td>Streamlit does not support CSP or any other Header methods to prevent clickjacking attacks.</td>
    <td></td>
</tr>
<tr>
    <td>L2</td>
    <td> Content Security Policy (CSP) Header Not Set</td>
    <td> There are two way to set content security policies.
    a) HTML meta tag and HTTP response header. This application is not using HTML</td>
    <td> Burb Suite Clickbandit revealed every possible click on the website is subject to clickjacking.
The report can be viewed in the link below</td>


</tr>
</table>

<p><br></p>
<h4 style='color:rgb(167, 22, 102)'>L1 | Clickjacking: Testing</h4>

<p><a href="../clickjacked.html">Clickjacking Report</a></p>
<p>Further attempt to see if an <code>&lt;iframe&gt;</code> can be inserted I ran an attack using a basic test to see how the site handles dangerous characters, using Burb Suit.</p>
<p><strong>Attack</strong></p>
<p>Clickjacking file on local instance:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>&lt;!DOCTYPE html&gt;&lt;html&gt;
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>&lt;head&gt;
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>&lt;title&gt;Clickjacking Test&lt;/title&gt;
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>&lt;/head&gt;
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>&lt;body&gt; 
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>&lt;iframe src=&quot;http://127.0.0.1:5000/&quot;&gt;
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>&lt;/iframe&gt;
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>&lt;/body&gt;
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>&lt;/html&gt;
</span></code></pre></div>
<p><strong>Results</strong></p>
<p><b style='color:red'> FAIL</b>
<a class="glightbox" href="../image-56.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Alt text" src="../image-56.png" /></a></p>
<p><strong>Attack</strong></p>
<p>Clickjacking basic test to see how site handles 'dangerous characters' input through  Burp Suite:</p>
<p><a class="glightbox" href="../image-54.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Alt text" src="../image-54.png" /></a></p>
<p><strong>Results</strong></p>
<p>Website response
<a class="glightbox" href="../image-53.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Alt text" src="../image-53.png" /></a></p>
<p>Burp Suite header response 
<a class="glightbox" href="../image-57.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Alt text" src="../image-57.png" /></a></p>
<p><strong>Attack</strong>
Clickjacking file on live site hosted on Render.com:</p>
<h4 style='color:rgb(167, 22, 102)'>L2: Testing</h4>

<p>When attempting a basic Reflective XSS <code>&lt;script&gt;alert()&lt;/script&gt;</code> no script got injected.</p>
<h2 id="resolution">Resolution</h2>
<p>Streamlit hardcoded "allowed-message-origin" into their stack. This refers to Cross-Origin Resource Sharing (CORS) security headers </p>
<p><a class="glightbox" href="../image-55.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Alt text" src="../image-55.png" /></a></p>
<h4 style='color:rgb(167, 22, 102)'>L2: Solution</h4>
<p>Reflective XSS: <a href="https://www.cobalt.io/blog/a-pentesters-guide-to-cross-site-scripting-xss">Remove</a> blacklisted characters '';! - "<XSS>=&amp;{()} scritp SCRIOT.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>      newname=&quot;&quot;
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>      newnumber=&quot;&quot;
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>      newemail=&quot;&quot;
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>        for name in form_name:
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>            if name == &quot;;&quot; or name ==&quot;!&quot; or name ==&quot;-&quot;or name ==&quot;&lt;&quot;or name ==&quot;XSS&quot;or name ==&quot;&gt;&quot;or name ==&quot;=&quot;or name == &quot;&amp;&quot; or name == &quot;(&quot;or name == &quot;)&quot;or name == &quot;{&quot;or name == &quot;}&quot; or name == &quot;SCRIPT&quot;or name == &quot;script&quot;:
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>                name = &quot;&quot;
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>            else:
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>                newname=newname+name
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>         for email in form_email:
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>            if email == &quot;;&quot; or email ==&quot;!&quot; or email ==&quot;-&quot;or email ==&quot;&lt;&quot;or email ==&quot;XSS&quot;or email ==&quot;&gt;&quot;or email ==&quot;=&quot;or email == &quot;&amp;&quot; or email == &quot;(&quot;or email == &quot;)&quot;or email == &quot;{&quot;or email == &quot;}&quot;email == &quot;SCRIPT&quot; or email ==&quot;script&quot;:
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>                email = &quot;&quot;
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>            else:
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>                newemail=newemail+email
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>         for number in form_number:
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a>            if number == &quot;;&quot; or number ==&quot;!&quot; or number ==&quot;-&quot;or number ==&quot;&lt;&quot;or number ==&quot;XSS&quot;or number ==&quot;&gt;&quot;or number ==&quot;=&quot;or number == &quot;&amp;&quot; or number == &quot;(&quot;or number == &quot;)&quot;or number == &quot;{&quot;or number == &quot;}&quot;number ==&quot;SCRIPT&quot;or number ==&quot;script&quot;:
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a>                number = &quot;&quot;
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a>            else:
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a>                newnumber=newenumber+number
</span></code></pre></div>
<p><a class="glightbox" href="../image-50.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Alt text" src="../image-50.png" /></a></p>
<p>After Input has been sanitised</p>
<p><a class="glightbox" href="../image-51.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Alt text" src="../image-51.png" /></a><a class="glightbox" href="../image-52.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Alt text" src="../image-52.png" /></a></p>
<hr />
<h1 id="fang-services">Fang Services</h1>
<h3 style="color:rgb(167, 22, 102)">Goal</h3>

<p>The goal is to imporve my application security and reduce the risk of attacks by testing the application througout the Software Development Life Cycle set out by OWASP.
This document is recording the 'the test early and test often' methodology applied threat modeling, automated testing (Snyk), code review and pentesting techniques.  </p>
<h3 style="color:rgb(167, 22, 102)">The Journey</h3>

<h2 id="application-vulnerability-score_1">Application Vulnerability Score</h2>
<table>
<thead>
<tr>
<th style="text-align: left;">PHASE</th>
<th style="text-align: left;">Vulnerability Score</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Before Development Begins</td>
<td style="text-align: left;"><p style='color:RED'>CRITICAL</p></td>
</tr>
<tr>
<td style="text-align: left;">During Design</td>
<td style="text-align: left;"><p style='color:RED'>CRITICAL</p></td>
</tr>
<tr>
<td style="text-align: left;">Before Launch</td>
<td style="text-align: left;"><p style='color:green'>ZERO</p></td>
</tr>
<tr>
<td style="text-align: left;">Launched</td>
<td style="text-align: left;"><p style='color:orange'>MEDIUM</p></td>
</tr>
</tbody>
</table>
<h2 id="before-development-begins">Before Development Begins</h2>
<p><strong> Lessons learnt </strong>
💪 Application headers to prevent cross site scripting
<div class="language-text highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>@app.after_request
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>def add_security_headers(resp):
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>    resp.headers[&#39;Content-Security-Policy&#39;] = &quot;default-src &#39;self&#39;&quot;
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>    return resp
</span></code></pre></div></p>
<hr />
<p>A threat model using Microsoft Thread Modeling Tool was created to identify the possible threats on a typical login form.
The results identified an extensive list of threats that can be avoided during built and the basis of the metrics criteria.</p>
<p><strong> Threat Model </strong></p>
<p>The standard Login Threat Model based on original design
<a class="glightbox" href="../image-9.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Login Threat Model" src="../image-9.png" /></a></p>
<p><strong> Measurement and Metrics Criteria and Ensure Traceability </strong></p>
<p>Denial Of Service</p>
<ul class="task-list">
<li class="task-list-item">
<p><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Potential Excessive Resource Consumption for Web Application or check login credentials </p>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Use Multi-Factor Authentication (MFA)</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Limit Login Attempts <br><br>
Other</li>
<li>Credential Storage : Store user credentials securely using hashing and salting techniques <a href="../cryptography/">see cryptography</a><br></li>
<li>Credential Verification : hash the provided password in the same way as the stored hash, and compare the two. If they match, the password is correct.<a href="../cryptography/">see cryptography</a><br></li>
<li>Secure Transmission : Always transmit credentials securely using encryption protocols like HTTPS.<a href="../networking/">see network</a><br></li>
<li>Use load balancing : Distribute traffic across multiple servers<a href="../networking/">see network</a><br></li>
<li>Implement server-side caching : This can reduce the number of requests to the server<a href="../networking/">see network</a><br></li>
<li>Monitor and log server activity : This can help detect and respond to unusual resource consumption<a href="../networking/">see network</a><br>
<br></li>
</ul>
</li>
<li class="task-list-item">
<p><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Data Flow HTTPS Is Potentially Interrupted</p>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Implement a Web Application Firewall (WAF)<a href="../networking/">see network</a><br><br> </li>
</ul>
</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Potential Process Crash or Stop for Web Application <p style="color:rgb(167, 22, 102)"> outside of scope<p></li>
</ul>
<p><br>
Elevation of Privilege</p>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Cross Site Request Forgery </li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Elevation by Changing the Execution Flow in Web Application </li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Web Application May be Subject to Elevation of Privilege Using Remote Code Execution </li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Elevation Using Impersonation</li>
</ul>
<p>Information Disclosure</p>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Weak Credential Storage</li>
</ul>
<p>Repudiation</p>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Potential Weak Protections for Audit Data </li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Insufficient Auditing </li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Lower Trusted Subject Updates Logs</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Data Logs from an Unknown Source </li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Potential Data Repudiation by Web Application</li>
</ul>
<p>Tampering</p>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Risks from Logging </li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Cross Site Scripting</li>
</ul>
<p>Spoofing</p>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Spoofing of Destination Data Store login</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Spoofing the Browser External Entity</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Spoofing of Destination Data Store SQL Database <a href="../database/">see database</a></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Spoofing of Source Data Store check login credentials <a href="../database/">see database</a></li>
</ul>
<p><strong> Authentication </strong>: Use standard authentication mechanisms to verify the identity of the source data store. This could involve using secure protocols such as HTTPS which provide built-in authentication.</p>
<p><strong> Input Validation </strong>: Ensure that all inputs are validated and sanitized to prevent malicious inputs from being processed.</p>
<p><strong> Least Privilege Access </strong>: Implement least privilege access controls so that even if an attacker is able to spoof a source, they would not have sufficient privileges to perform harmful actions</p>
<p><strong> Monitoring and Logging</strong> : Regularly monitor and log activities to detect any unusual behavior or access patterns</p>
<h2 id="during-design">During Design</h2>
<p><strong><em>Security Requirements</em></strong></p>
<ul>
<li>User management</li>
<li>Authentication</li>
<li>Authorization</li>
<li>Data confidentiality</li>
<li>Integrity</li>
<li>Accountability</li>
<li>Session management</li>
<li>Transport security</li>
<li>Tiered system segregation </li>
</ul>
<p><strong> Step 1 : Basic Login and possible vulnerabilities </strong></p>
<p>Is started out with a standard login page and listed the common vulnerabilities.</p>
<p><a class="glightbox" href="../image-17.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Step1" src="../image-17.png" /></a></p>
<p><strong> Step 2 : Improved vulnerabilities through design </strong></p>
<p>Redesigned the login page to remove design vulnerabilities:</p>
<p><a class="glightbox" href="../image-29.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Alt text" src="../image-29.png" /></a>
<a class="glightbox" href="../image-30.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Alt text" src="../image-30.png" /></a> 
<a class="glightbox" href="../image-31.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Alt text" src="../image-31.png" /></a> 
<a class="glightbox" href="../image-33.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Alt text" src="../image-33.png" /></a>
<a class="glightbox" href="../image-34.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Alt text" src="../image-34.png" /></a>
<a class="glightbox" href="../image-36.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Alt text" src="../image-36.png" /></a></p>
<p>Logging returning after user has completed the verification
<a class="glightbox" href="../image-37.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Alt text" src="../image-37.png" /></a> </p>
<h2 id="during-development_1">During Development</h2>
<p>💢 <strong> The line between security and convenience </strong></p>
<p>The first hurdle is to reduce the risks wihtout building an annoying user experience.</p>
<p>During the development phase the design concept was combined with the practical aproach with questions like:</p>
<ul>
<li>Remove the risk of a weak password with a unique passphrase (token) emailed to user,</li>
<li>Enforce One Time Passcode,</li>
<li>Implement captcha,</li>
<li>all of the above</li>
</ul>
<p><br></p>
<p><a class="glightbox" href="../image-38.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Alt text" src="../image-38.png" /></a></p>
<p>Secure: Flask provides built-in support for handling common web security features like cross-site request forgery (CSRF) protection and secure cookie handling.</p>
<p><strong><em>References</em></strong></p>
<p><a href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/03-Identity_Management_Testing/README">Testing for Account Enumeration and Guessable User Account</a></p>
<p><a href="https://www.strongdm.com/blog/authentication-vulnerabilities">11 Common Authentication Vulnerabilities You Need to Know</a></p>
<hr />
<hr />
<h2 id="cybok-knowledge-applied">CyBOK knowledge applied</h2>
<ul>
<li>
<p><strong>categories of vulnerabilities</strong></p>
<ul>
<li><strong>CVEs and CWEs</strong></li>
<li>
<p><strong>memory management vulnerabilities</strong></p>
<p>attacks</p>
<p>code corruption attacks</p>
<p>control-flow hijack attacks</p>
<p>information leak attack</p>
<p>data-only-attacks</p>
<p>safe languages</p>
<p>temporal vulnerabilities</p>
<p>spatial vulnerabilities</p>
</li>
<li>
<p>structured output generation vulnerabilities</p>
<p>SQL injection</p>
<p>command injection vulnerabilities</p>
<p>script injection vulnerabilities (XSS)</p>
<p>stored injection vulnerabilites</p>
<p>higher-order injection vulnerabilities</p>
</li>
<li>
<p><strong>race condition vulnerabilities</strong></p>
<p>concurrency bugs</p>
<p>time-of-check to time-of-use</p>
</li>
<li>
<p><strong>API vulnerabilities</strong></p>
<p>correct use</p>
<p>correct implementation</p>
</li>
<li>
<p><strong>side-channel vulnerabilities</strong></p>
<p>software-based side-channels</p>
<p>covert channels</p>
<p>micro-architectual effects</p>
<p>fault-injection attacks</p>
<p>physical fault-injection</p>
<p>software fault-injection</p>
<p>Rowhammer</p>
</li>
</ul>
</li>
<li>
<p><strong>prevention of vulnerabilities</strong></p>
<ul>
<li>
<p><strong>API design</strong></p>
<p>defensive programming</p>
<p>sandboxing</p>
<p>principle of least privilege</p>
<p>assertions</p>
<p>contracts</p>
</li>
<li>
<p><strong>coding practices</strong></p>
<p>coding guidelines</p>
<p>MISRA</p>
<p>dangerous functions</p>
<p>programming idioms</p>
<p>resource acquisition is initialisation</p>
<p>move semantics</p>
<p>smart pointers</p>
<p>checking compliance</p>
</li>
<li>
<p><strong>erroneous execution</strong></p>
<p>trapped errors</p>
<p>untrapped errors</p>
</li>
<li>
<p><strong>language design and type systems</strong></p>
<p>memory management mitigations</p>
<p>immutable state</p>
<p>dynamic checks</p>
<p>static checks</p>
</li>
<li>
<p><strong>structured output generations mitigations</strong></p>
<p>type systems</p>
<p>query generation</p>
</li>
<li>
<p><strong>race condition mitigation</strong></p>
<p>ownership</p>
<p>aliasing</p>
</li>
<li>
<p><strong>information flow</strong></p>
</li>
<li><strong>mitigating exploitation</strong></li>
<li>
<p><strong>runtime detection of attacks</strong></p>
<p>stack canaries
non-executable memory</p>
<p>control fow integrity</p>
</li>
<li>
<p><strong>automated software diversity</strong></p>
<p>ASLR</p>
</li>
<li>
<p><strong>limiting privileges</strong></p>
<ul>
<li>
<p><strong>sandboxing</strong></p>
<p>monitors</p>
<p>jails</p>
</li>
</ul>
<p>compartmentalisation</p>
<p>object-capability systems</p>
</li>
</ul>
</li>
<li>
<p><strong>detection of vulnerabilities</strong></p>
</li>
</ul></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../js/jquery-3.6.0.min.js"></script>
        <script src="../js/bootstrap.min.js"></script>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js"></script>

        <div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    <script>const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});</script></body>
</html>
