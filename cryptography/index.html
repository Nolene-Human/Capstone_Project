<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="https://cybersecurity1.com/cryptography/">
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Cryptography - NoleneHuman__Capstone</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css">
        <link href="../stylesheets/extra.css" rel="stylesheet">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-dark">
            <div class="container">
                <a class="navbar-brand" href="..">NoleneHuman__Capstone</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href=".." class="nav-link">Home</a>
                            </li>
                            <li class="navitem">
                                <a href="../security/" class="nav-link">Scope</a>
                            </li>
                            <li class="navitem">
                                <a href="../networking/" class="nav-link">Network</a>
                            </li>
                            <li class="navitem">
                                <a href="../application/" class="nav-link">Application</a>
                            </li>
                            <li class="navitem active">
                                <a href="./" class="nav-link">Cryptography</a>
                            </li>
                            <li class="navitem">
                                <a href="../database/" class="nav-link">Database</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../application/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../database/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#cybok-knowledge-applied" class="nav-link">CyBOK knowledge applied</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#data-encryption-mechanisms-tls-transport-layer-security-data-at-rest" class="nav-link">Data Encryption Mechanisms / TLS (Transport Layer Security) / Data At Rest</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<p><img alt="Scanned Network" src="../cry.png" /></p>
<h3 style="color:rgb(167, 22, 102)">Goal</h3>

<p>The goal is to understand and implement relevant CyBOK topics in my application as possible. Here the reader can follow my learnings and reason for applying certain cryptography methods.  </p>
<h3 style="color:rgb(167, 22, 102)">The Journey</h3>

<p>Outcome based on threat modeling</p>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Store user credentials securely using hashing and salting techniques.(instead of plain text).</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Hash the provided password in the same way as the stored hash, if they match, the password is correct.</li>
</ul>
<hr />
<h1 id="cybok-knowledge-applied">CyBOK knowledge applied</h1>
<p><strong> Schemes </strong></p>
<p>ðŸ’ª</p>
<h3 id="data-encryption-mechanisms-tls-transport-layer-security-data-in-transit">Data Encryption Mechanisms / TLS (Transport Layer Security) / Data In Transit</h3>
<p>An admin application is using python and gmail to send a response to clients enquiry. </p>
<p><img alt="Alt text" src="../image-20.png" /></p>
<h3 id="before">Before</h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>import smtplib
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>server=smtplib.SMTP(&#39;smtp.gmail.com&#39;,587)
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>server.starttls()
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>server.login(&#39;onlyforshowhack@gmail.com&#39;,&#39; **** **** **** **** &#39;)
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>email=input(&quot;Enter email address: &quot;)
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>name=input (&quot;Enter Name: &quot;)
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>send=input( &quot;Send payment y/n: &quot;)
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>server.sendmail(&#39;onlyforshowhack@gmail.com&#39;,email,&#39;&quot;Hi from Fang&#39;)
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>print(&#39;mail sent&#39;)
</span></code></pre></div>
<p><img alt="Alt text" src="../image-21.png" /></p>
<h3 id="after">After</h3>
<p>Two things was improved.</p>
<p>a) Changing SSL / TLS to communicate on port 465 instead of 587 as port 465 encrypt from start of message,ensuring that the connection is secure from the beginning vs 587 that start out with plain text and upgrade to TLS if possible.</p>
<p>Because this message will  hold secret information it will need to be encrypted from start to finish</p>
<p>and</p>
<p>c) encrypting email password using os environment variables</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>import smtplib
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>import os
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>import ssl
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>from email.message import EmailMessage
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a># password is stored in os environment
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>email_password=os.environ.get(&#39;admin_gmail&#39;)
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>#admin register new user
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>email_to=input(&quot;Enter email address: &quot;)
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>name=input (&quot;Enter Name: &quot;)
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>send=input( &quot;Send payment y/n: &quot;)
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a>
</span><span id="__span-1-17"><a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a>
</span><span id="__span-1-18"><a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a>#create email
</span><span id="__span-1-19"><a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a>em = EmailMessage()
</span><span id="__span-1-20"><a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a>em[&#39;From&#39;]= &#39;onlyforshowhack@gmail.com&#39;
</span><span id="__span-1-21"><a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a>em[&#39;To&#39;] = email_to
</span><span id="__span-1-22"><a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a>em[&#39;Subject&#39;]=&#39;Introduction from FANG&#39;
</span><span id="__span-1-23"><a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a>
</span><span id="__span-1-24"><a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a>em.add_alternative(&quot;&quot;&quot;\
</span><span id="__span-1-25"><a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a>&lt;!DOCTYPE html&gt;
</span><span id="__span-1-26"><a id="__codelineno-1-26" name="__codelineno-1-26" href="#__codelineno-1-26"></a>&lt;html&gt;  
</span><span id="__span-1-27"><a id="__codelineno-1-27" name="__codelineno-1-27" href="#__codelineno-1-27"></a>    &lt;body&gt;
</span><span id="__span-1-28"><a id="__codelineno-1-28" name="__codelineno-1-28" href="#__codelineno-1-28"></a>
</span><span id="__span-1-29"><a id="__codelineno-1-29" name="__codelineno-1-29" href="#__codelineno-1-29"></a>        &lt;h2 style=&quot;color:rgb(167, 22, 102)&quot;&gt;Welcome to FANG&lt;/h2&gt;           
</span><span id="__span-1-30"><a id="__codelineno-1-30" name="__codelineno-1-30" href="#__codelineno-1-30"></a>
</span><span id="__span-1-31"><a id="__codelineno-1-31" name="__codelineno-1-31" href="#__codelineno-1-31"></a>    &lt;/body&gt;
</span><span id="__span-1-32"><a id="__codelineno-1-32" name="__codelineno-1-32" href="#__codelineno-1-32"></a>&lt;/html&gt;
</span><span id="__span-1-33"><a id="__codelineno-1-33" name="__codelineno-1-33" href="#__codelineno-1-33"></a>&quot;&quot;&quot;, subtype=&#39;html&#39;)
</span><span id="__span-1-34"><a id="__codelineno-1-34" name="__codelineno-1-34" href="#__codelineno-1-34"></a>
</span><span id="__span-1-35"><a id="__codelineno-1-35" name="__codelineno-1-35" href="#__codelineno-1-35"></a>
</span><span id="__span-1-36"><a id="__codelineno-1-36" name="__codelineno-1-36" href="#__codelineno-1-36"></a>#create a self signed SSL certificate for local(host) application.
</span><span id="__span-1-37"><a id="__codelineno-1-37" name="__codelineno-1-37" href="#__codelineno-1-37"></a>context=ssl.create_default_context()
</span><span id="__span-1-38"><a id="__codelineno-1-38" name="__codelineno-1-38" href="#__codelineno-1-38"></a>
</span><span id="__span-1-39"><a id="__codelineno-1-39" name="__codelineno-1-39" href="#__codelineno-1-39"></a># initiating connection
</span><span id="__span-1-40"><a id="__codelineno-1-40" name="__codelineno-1-40" href="#__codelineno-1-40"></a>with smtplib.SMTP_SSL(&#39;smtp.gmail.com&#39;,465,context=context) as smtp:
</span><span id="__span-1-41"><a id="__codelineno-1-41" name="__codelineno-1-41" href="#__codelineno-1-41"></a>    smtp.login(&#39;onlyforshowhack@gmail.com&#39;,email_password)
</span><span id="__span-1-42"><a id="__codelineno-1-42" name="__codelineno-1-42" href="#__codelineno-1-42"></a>    smtp.sendmail(&#39;onlyforshowhack@gmail.com&#39;,email_to,em.as_string())
</span><span id="__span-1-43"><a id="__codelineno-1-43" name="__codelineno-1-43" href="#__codelineno-1-43"></a>
</span><span id="__span-1-44"><a id="__codelineno-1-44" name="__codelineno-1-44" href="#__codelineno-1-44"></a>#console log
</span><span id="__span-1-45"><a id="__codelineno-1-45" name="__codelineno-1-45" href="#__codelineno-1-45"></a>print(&#39;email sent&#39;)
</span></code></pre></div>
<p><img alt="Alt text" src="../image-24.png" /></p>
<p><br></p>
<h2 id="data-encryption-mechanisms-tls-transport-layer-security-data-at-rest">Data Encryption Mechanisms / TLS (Transport Layer Security) / Data At Rest</h2>
<p>Database</p>
<hr />
<hr />
<p><strong><em>Full Cybok list of knowledge</em></strong></p>
<ul>
<li>
<p><strong>schemes</strong></p>
<p>AES</p>
<p>RSA</p>
<p>DES</p>
<p>PKCS</p>
<p>DSA</p>
<p>Kerberos</p>
<p>âœ… TLS</p>
</li>
<li>
<p><strong>symmetric cryptography</strong></p>
<ul>
<li>
<p><strong>symmetric primitives</strong></p>
<p>block ciphers</p>
<p>Feistel networks</p>
<p>stream ciphers                            </p>
<p>hash functions</p>
<p>Merkel-Damgard construction</p>
<p>sponge constructions</p>
</li>
<li>
<p><strong>symmetric encryption and authentication</strong></p>
<p>modes of operation</p>
<p>ECB
CBC
OFB
CFB
CTR
AEAD</p>
<p>message authentication codes</p>
<p>extendable output function</p>
<p>key derivation functions</p>
</li>
</ul>
</li>
<li>
<p><strong>public key encryption</strong></p>
<p>public key cryptography</p>
<p>key encapsulation mechanisms</p>
<p>constructions based on RSA</p>
<p>RSA-OAEP</p>
<p>RSA-KEM</p>
<p>âœ… data encryption mechanisms:
âœ… In transit,
at rest,
end to end,</p>
<p>constructions based on elliptic curves</p>
<p>ECIES</p>
<p>lattice-based constructions</p>
<p>public key signatures</p>
<p>full domain hash</p>
<p>probabilistic signature schemes</p>
<p>Schnorr signatures</p>
</li>
<li>
<p><strong>cryptographic security models</strong></p>
<ul>
<li>
<p>basic security definitions</p>
<p>security games</p>
<p>random oracle model</p>
<p>one-way
passive attack
indistinguishability
chosen plaintext attacks
chosen ciphertext attack
universal forgery
chosen message attack</p>
</li>
<li>
<p>hard problems</p>
<p>pseudo-random permutations</p>
<p>pseudo-random functions
discrete logarithm problem
Dife-Hellman problem
shortest vector problem</p>
<p>post-quantum cryptography</p>
<p>closest vector problem</p>
</li>
<li>
<p>setup assumptions</p>
<p>PKI</p>
</li>
<li>
<p>simulation of cryptographic operations</p>
<p>common reference strings</p>
<p>good random number generation</p>
</li>
<li>
<p>universal composability</p>
</li>
<li><strong>information-theoretically secure constructions</strong></li>
</ul>
<p>one-time pad</p>
<p>secret sharing</p>
</li>
<li>
<p><strong>Standard protocols</strong></p>
<ul>
<li>
<p>authentication protocols</p>
<p>encryption-based protocols</p>
<p>message authentication-based protocols</p>
<p>zero-knowledge-based protocols  - pro </p>
</li>
<li>
<p>key agreement protocols</p>
<p>key confirmation</p>
<p>forward secrecy</p>
<p>unknown key share security</p>
<p>key transport</p>
<p>Diffie-Hellman key agreement</p>
<p>station-to-station protocol</p>
</li>
</ul>
</li>
<li>
<p><strong>advanced protocols</strong></p>
<p>oblivious transfer</p>
<p>zero-knowledge</p>
<p>Î£-protocols</p>
<p>secure multi-party computation</p>
</li>
<li>
<p><strong>public-key schemes with special properties</strong></p>
</li>
</ul></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../js/jquery-3.6.0.min.js"></script>
        <script src="../js/bootstrap.min.js"></script>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js"></script>
        <script src="../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
